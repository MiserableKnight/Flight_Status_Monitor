# 时区策略说明

## ⚠️ 重要：项目时间统一使用北京时间

### 设计原则
为了保证项目在任何时区的服务器上都能正常运行，本项目采用**时区无关**的设计：

- **内部时间**：统一使用北京时间 (UTC+8)
- **数据存储**：所有时间数据以北京时间存储
- **调度逻辑**：所有调度判断基于北京时间
- **邮件展示**：转换为越南时间显示 (北京时间-1小时)

### 时间转换规则

```
越南时间 + 1小时 = 北京时间
北京时间 - 1小时 = 越南时间
```

### 各模块时间说明

#### 1. 配置文件 (`config/flight_schedule.py`)
- 所有时间配置使用**北京时间**
- 例如：VJ105 计划起飞 `07:45` (北京时间)
- 对应越南时间：`06:45`

#### 2. 数据存储 (`data/leg_data.csv`)
- 所有时间数据以**北京时间**存储
- OUT/OFF/ON/IN 时间均为北京时间

#### 3. 调度逻辑 (`main_scheduler.py`)
- 所有时间比较使用**北京时间**
- `parse_time()` 解析的时间为北京时间

#### 4. 邮件通知 (`leg_status_monitor.py`)
- 内部处理使用**北京时间**
- 发送邮件时转换为**越南时间**显示
- 使用 `parse_time_vietnam()` 函数转换

### 工具函数

```python
# 北京时间 → 越南时间（用于邮件展示）
from config.flight_schedule import FlightSchedule
vietnam_time = FlightSchedule.to_vietnam_time(beijing_datetime)

# 格式化越南时间字符串
vietnam_str = FlightSchedule.format_vietnam_time(beijing_datetime, format_str='%H:%M')
```

### 修改时间配置

如需修改航班计划时间，请：
1. 将**越南时间**转换为**北京时间**（+1小时）
2. 在 `config/flight_schedule.py` 中修改配置
3. 添加注释说明原始越南时间

### 验证方法

启动项目后检查：
```
📋 今日航班计划:
  VJ105: 计划起飞 07:45 (北京时间)
           航程 110分钟, 航线 HAN-VCS
```

- 配置文件显示：北京时间
- 邮件通知显示：越南时间
- 数据库存储：北京时间

### 时区无关性

此设计确保：
- ✅ 在国内服务器运行：使用系统时间（北京时间）
- ✅ 在越南服务器运行：代码内部使用北京时间，与系统时区无关
- ✅ 在任何时区运行：代码内部使用北京时间，保证逻辑一致
